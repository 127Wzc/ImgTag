# Docker Compose 配置示例
# 需要已有 PostgreSQL 数据库（启用 pgvector 扩展）
#
# 使用方式：
# curl -O https://raw.githubusercontent.com/127Wzc/ImgTag/main/docker/docker-compose.yml
# 然后编辑 environment 中的数据库连接，执行 docker-compose up -d

services:
  imgtag:
    image: 127wzc/imgtag:latest
    container_name: imgtag
    ports:
      # 全栈版统一端口（前端 + 后端 API）
      - "5173:8000"
    environment:
      # 必填：PostgreSQL 连接字符串
      - PG_CONNECTION_STRING=postgresql://user:password@host:5432/imgtag
    volumes:
      # 统一数据目录（所有本地存储 bucket 都在此目录下）
      # 例如：./data/uploads, ./data/test, ./data/images 等
      - ./data:/app/data
      # 本地嵌入模型目录（可选，支持离线运行）
      # 预置模型后容器启动时无需联网下载
      - ./models:/app/models
    restart: unless-stopped
